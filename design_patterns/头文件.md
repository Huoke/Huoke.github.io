<h1 align="center">头文件</h1>
对于C语言来说，头文件的设计体现了大部分的系统设计。
正确使用头文件可使得代码在可读性、文件大小和编译构建性能上大为改观。

本章目标是帮助合理规划头文件
## 一、头文件职责
 - 它是模块或文件的对外接口
 - 适合放置接口的声明，不适合放置实现(内联函数除外)。
 - 文件职责单一。头文件过于复杂，依赖过于复杂还是导致编译时间过长的主要原因。
### 1.1 每一个源文件都应该有相应的头文件，用于声明需要对外公开的接口。
每一个.c文件都有一个相应的.h文件，名称不一定同名。用于放置对外提供的接口、宏定义、类型定义等。如果一个.c文件不需要对外公布任何接口，则其就不应当存在。
也有例外：main、测试代码、动态库代码等。
### 1.2 只能使用.h，不使用非习惯用法的扩展名，如.inc
## 二、头文件依赖

头文件包含是一种依赖关系，头文件应该向稳定的方向包含。
应当让不稳定的模块依赖稳定的模块，从而当不稳定的模块发生变化时，不会影响(编译)稳定的模块。

依赖的方向应该是: 产品依赖于平台、平台依赖于标准库。

除了不稳定的模块依赖于稳定的模块外，更好的方式是每个模块都依赖于接口，这样任何一个模块的内部实现更改都不需要更新编译另外一个模块，这里，假设接口本身是最稳定的。
### 2.1 禁止头文件循环依赖
设计和架构上的不合理。需要优化架构！
### 2.2 禁止包含用不到的头文件
### 2.3 头文件应当自包含
自包含就是任意一个头文件均可独立编译。
### 2.4 头文件必须编写保护，防止重复包含
### 2.5 禁止通过声明的方式引入外部函数接口、变量
只能通过包含头文件的方式使用其他模块或文件提供的接口。
通过 extern 声明的方式使用外部函数接口、变量，容易在外部接口改变时可能导致声明和定义不一致。
同时这种隐式依赖，容易导致架构腐化。
例外，有些场景需要引用其内部函数，但并不想侵入代码时，可以 extern 声明方式引用。
如：
针对某一内部函数进行单元测试时，可以通过 extern 声明来引用被测函数；
当需要对某一函数进行打桩、打补丁处理时，允许 extern 声明该函数。
### 2.6 禁止在 extern "C" 中包含头文件

按照 a.h 作者的本意，函数 Foo 是一个 C++ 自由函数，其链接规范为 "C++"。
但在 b.h 中，由于 #include "a.h" 被放到了 extern "C" 的内部，函数 Foo 的链接规范被不正确地更改了。

例外：
如果在 C++ 编译环境中，想引用纯C的头文件，这些C头文件并没有 extern "C" 修饰。非侵入式的做法是，在 extern "C" 中去包含C头文件。
